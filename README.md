# Description
- 機能
  - 画像を、一定の縦横比を保ったままトリミングできます
  - 回転してトリミングすることもできます
- 開発の目的
  - 前回(MyTrimmingNew)の多数の反省点を受け、BDDを前提に再度開発したらどうなるかを確認するために再開発しました
- 前回からの改善点
  - 機能面
    - 矩形を回転している場合でも矩形を拡大/縮小可能にしました
    - 回転してトリミングする際、画像のジャギーを低減するロジックを実装しました
    - 回転してトリミングする際に進捗のプログレスバー表示を追加しました
  - 開発面
    - テスト側にロジックを2重実装しませんでした
    - 機能テスト＝受け入れテストと呼べるものを実装しました
- 注意事項
  - ~~回転してトリミングする際の処理は相変わらず遅いです~~
    - Ver. 1.1.0 にてある程度高速化しました。1920 x 1080 画像なら補正込みで 23 秒 -> 3 秒程度にしました
      - 高速化作業履歴は SpeedUp ブランチを参照ください
    - Ver. 1.1.1 にて更に高速化しました、1920 x 1080 画像なら補正込みで 3 秒 -> 0.5秒程度にしました
      - 高速化作業履歴は SpeedUp2 ブランチを参照ください

# History
|日付      |タグ  |内容|
|---       |---   |--- |
|2024/ 1/ 5|v1.2.0|.NET Framework バージョンを 4.5 から 4.8 に更新|
|2021/10/16|v1.1.2|BitmapDataの色の並び順の間違いを修正|
|2021/10/13|v1.1.1|画像保存処理を更に高速化|
|2021/ 9/11|v1.1.0|見た目からテスト用情報を削除、画像保存処理の高速化|
|2021/ 6/16|v1.0.0|初回実装|

# Usage

## 基本的な流れ

```
画像ファイルオープン
↓
赤色の矩形を変更し、切り取り範囲を指定
↓
(プレビュー画面により、切り取り後にどのような見た目になるかを確認)
↓
別名保存により、切り取り範囲を画像として保存
```

## 切り取り範囲を示す赤枠矩形
### 操作
```
矩形の隅以外でのドラッグ＆ドロップ : 移動
矩形の隅でのドラッグ＆ドロップ     : 拡大/縮小
```

### 制約
- 矩形の回転は、-80度 〜 +80度程度に抑えてください
  - ソフト側で制約をかけることはTODOです

## キーボードショートカット
### ファイル関係
```
"Ctrl" + "o" : 画像ファイルオープン
"Ctrl" + "s" : 切り取り範囲を別名保存
```

### 切り取り範囲を示す赤枠矩形
```
";"                      : 時計回りに1度回転
"-"                      : 反時計回りに1度回転
"Shift" + ";"            : 時計回りに10度回転
"Shift" + "-"            : 反時計回りに10度回転
"カーソルキー"           : 1pixel単位での移動
"Shift" + "カーソルキー" : 10pixel単位での移動
"Ctrl" + "z"             : 取り消し
"Ctrl" + "y"             : やり直し
```

### その他
プレビュー機能(現時点の切り取り範囲で切り取ると、どんな見た目になるか)
```
"Ctrl" + "p" : プレビュー画面表示
```

# Install
コード公開のみ実施しています。お手数ですがご自身でビルドしてください。

# Requirement
- ビルドに必要な環境
  - Visual Studio
  - .NET Framework 4.8
- Nuget 取得Package
  - テスト
    - MSTest
      - MSTest.TestAdapter 2.1.2
      - MSTest.TestFramework 2.1.2
    - 自動化API
      - Codeer.Friendly 2.6.1
      - Codeer.Friendly.Windows 2.15.0
      - Codeer.Friendly.Windows.Grasp 2.12.0
      - RM.Friendly.WPFStandardControls 1.41.2

# Licence
- [MIT](https://github.com/tcnksm/tool/blob/master/LICENCE)
